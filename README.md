# Толстой или компьютер?

Ссылка на бота: https://t.me/tolstoy_or_computer_bot или @tolstoy_or_computer_bot

Ссылка на pythonanywhere: http://anastasiasaunina.pythonanywhere.com/

## Что делает бот?

Играет с пользователем в игру. Бот присылает пользователю два предложения: одно из них сгенерировано компьютером (при помощи word2vec или transformers), а второе -- взято из текстов Л.Н. Толстого. Задача пользователя -- угадать, какое предложение сгенерированное. Кроме этого, вместе с пользователем в эту игру играет модель: она тоже видит два предложения и пытается угадать сгенерированное. В любой момент пользователь может запросить статистику игры: сколько процентов угадала модель, а сколько -- он, общее число игр (текстом), общее число угадываний (текстом). В такой статистике он получает две картинки (вот пример):

<img src="https://github.com/asaunina/final_project_bot/assets/72650924/7f336460-b311-4af7-8018-3dfae16c6b92" width="600" height="350" />
<img src="https://github.com/asaunina/final_project_bot/assets/72650924/14f6e695-7cdc-4012-9676-5f5e6cf34a5b" width="400" height="350" />

Игра продолжается до тех пор, пока не закончатся все предложения в базе данных. 

Вот еще примеры того, что пишет бот!

<img src="https://github.com/asaunina/final_project_bot/assets/72650924/73523194-439f-4372-a36e-7f3c480deb32">
<img src ="https://github.com/asaunina/final_project_bot/assets/72650924/415f339a-c8d2-48d5-a3df-101cc3625e67">

### Что происходит "до"?

#### 1. Скачиваем тексты

Тексты Толстого скачиваются краулером с этого сайта: http://tolstoy-lit.ru/tolstoy/proza/index.htm и добавляются в файлик (есть в репозитории)

*(не все, а то работает 10000000 лет)*

#### 2. Учим word2vec модель на скачанных текстах и генерируем предложения

После обучения модели генерируем предложения: проходимся по списку исходных предложений (не всех) и заменяем некоторые слова самыми близкими, по мнению модели, словами. Пытаемся также сохранить форму исходного слова, чтобы было согласование. 

*(получается не очень... поэтому..!!)*

#### 3. Генерируем больше предложений!

При помощи transformers и pipeline('text-generation') генерируем больше предложений на основе первых трех слов из исходных предложений! Получается уже лучше :)

#### 4. Обучаем классификатор

Обучаем классификатор knn на полученных данных (количество сгенерированных и настоящих предложений в итоге равное).

#### 5. Делаем бота и наслаждаемся игрой!

## Как устроен репозиторий

#### crawler_tolstoy.ipynb

Здесь код для обкачки сайта с текстами произведений. Очень долго работающий код. Сохраняет файлик с текстами

#### text_generation_tolstoy.ipynb 

Здесь код с генерацией предложений: через word2vec и через transformers.

Чтобы работало, например, через Jupyter, надо залогиниться с hugging_face.

#### all_info_tolstoy.csv

Файлик, получаемый после генерации

#### df1.csv, df2.csv

Вспомогательные файлы после генерации

#### calssification_tolstoy.ipynb

Файлик, где классифицируются предложения при помощи knn

#### final_tolstoy.csv

Здесь хранятся итоговые результаты после классификации -- но он не загрузился, потому что большой :( -- поэтому tolsotoy.zip!

#### bot.py

Наконец, финальный бот!

#### project_anastasiasaunina.ipynb

А здесь просто все собрано в одном большом файлике
